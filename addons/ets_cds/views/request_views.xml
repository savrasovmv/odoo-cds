<?xml version="1.0"?>
<odoo>

    <record id="cds_request_view_form" model="ir.ui.view">
        <field name="name">cds.request.form</field>
        <field name="model">cds.request</field>
        <field name="arch" type="xml">
            <form string="Заявка">
                <header>
                    <field name="state" widget="statusbar" options="{'clickable': '1', 'fold_field': 'fold'}"></field>   
                </header>
                <sheet>
                    <div class="oe_title">
                        <h3>
                        Заявка №
                        <field name="name"/>
                        от 
                        <field name="date"/></h3>
                    </div>        
                    
                    <group>
                        <group string="Объект">
                            <field name="energy_complex_id" options='{"no_create": 1, "no_create_edit": 1}'/>
                            <field name="location_id" />
                            <field name="company_partner_id" />
                            <field name="object_id" domain="[('energy_complex_id', '=', energy_complex_id)]" options='{"no_create": 1, "no_create_edit": 1}'/>
                        </group>
                        <group string="Создал">
                            <field name="user_id"/>
                            <field name="partner_id"/>
                            <field name="function"/>
                            
                        </group>
                    </group>
                    <notebook>
                        <page string="Параметры">
                            <group >
                                <group string="Работы" >
                                    <field name="mode"/>
                                    <field name="date_schedule"/>
                                    
                                    <label for="ready_hours" string="Аварийная готовность"/>
                                    <div class="o_row">
                                        <field name="ready_hours" nolabel="1" class="oe_inline"/>
                                        ч.
                                        <field name="ready_minutes" nolabel="1" class="oe_inline" />
                                        мин.
                                    </div>

                                </group>
                                <group string="Доп. информация">
                                    <field name="total_load_gpes"/>
                                    <field name="restrictions"/>
                                    <field name="oil_losses"/>
                                    
                                </group>
                                <group string="Период выполнения работ">
                                    <label for="date_work_start" string="План"/>
                                    <div class="o_row">
                                        с
                                        <field name="date_work_start" nolabel="1" class="oe_inline"/>
                                        по
                                        <field name="date_work_end" nolabel="1" class="oe_inline" />
                                    
                                    </div>

                                    <label for="date_turn_off" string="Факт"/>
                                    <div class="o_row">
                                        с
                                        <field name="date_turn_off" nolabel="1" class="oe_inline"/>
                                        по
                                        <field name="date_turn_on" nolabel="1" class="oe_inline" />
                                    
                                    </div>
                                    
                                </group>
                            </group>
                            <group>
                                <field name="work_name" />
                                <field name="description_mode"/>
                            </group>
                            
                        </page>
                        <page string="Согласование">
                            <group>
                                <group>
                                <field name="date_hand_over"/>
                                <!-- <field name="date_turn_off"/>
                                <field name="date_turn_on"/> -->
                                </group>
                            </group>
                            <group>
                            <div class="oe_button_box" name="button_box">
                                <button name="action_set_request_matching"
                                    type="object"
                                    class="oe_stat_button oe_edit_only"
                                    icon="fa-refresh" 
                                    string="Заполнить"
                                    attrs="{'invisible': [('state', '!=', 'draft')]}"
                                >
                                </button>
                            </div>
                            </group>
                            <field name="matching_ids">
                                <tree editable="botton">
                                    <field name="partner_id" options='{"no_create": 1, "no_create_edit": 1}'/>
                                    <field name="function"/>
                                    <field name="is_local"/>
                                    <field name="state"/>
                                    <field name="user_id"/>
                                    <field name="is_send"/>
                                    <field name="date_state"/>

                                </tree>
                                
                            </field> 

                        </page>

                    </notebook>  
                </sheet>
            </form>
        </field>
    </record>


    <record id="cds_request_view_tree" model="ir.ui.view">
        <field name="name">cds.request.tree</field>
        <field name="model">cds.request</field>
        <field name="arch" type="xml">
            <tree >
                <field name="date"/>
                <field name="name"/>
                <field name="energy_complex_id"/>
                <field name="object_id"/>
                <field name="state" decoration-danger="state=='failure'"/>
                <field name="partner_id"/>
            </tree>
        </field>
    </record>

    <record id="cds_request_view_search" model="ir.ui.view">
        <field name="name">cds.request.view.search</field>
        <field name="model">cds.request</field>
        <field name="arch" type="xml">
            <search string="Поиск Заявок">
                <field name="name"/>
                <field name="energy_complex_id"/>
                <field name="object_id"/>
                <field name="partner_id"/>
                <separator/>
                <filter name="completed" string="Completed" domain="[('state', '=', 'done')]"/>
                <group expand="0" string="Группировать по">
                    <filter name="group_by_company_partner_id" string="Заказчику" domain="[]" context="{'group_by': 'company_partner_id'}"/>
                    <filter name="group_by_energy_complex_id" string="Энергокомплексу" domain="[]" context="{'group_by': 'energy_complex_id'}"/>
                    <filter name="group_by_object_id" string="Объекту" domain="[]" context="{'group_by': 'object_id'}"/>
                </group>
            </search>
        </field>
    </record>
    
    <record id="cds_request_action" model="ir.actions.act_window">
        <field name="name">Заявки</field>
        <field name="res_model">cds.request</field>
        <field name="view_mode">tree,form,kanban</field>
        <field name="help" type="html">
          <p>
             Создайте новую запись
          </p>
        </field>
    </record>


    


    <!-- <record id="cds_request_state_action" model="ir.actions.act_window">
        <field name="name">Статусы</field>
        <field name="res_model">cds.request_state</field>
        <field name="view_mode">tree,form</field>
        <field name="help" type="html">
          <p>
             Создайте новую запись
          </p>
        </field>
    </record> -->

    <!-- <record id="base_multi_sync_line_action" model="ir.actions.act_window">
        <field name="name">Синхронизированные объекты</field>
        <field name="res_model">base.multi_sync_line</field>
        <field name="view_mode">tree,form</field>
        <field name="help" type="html">
          <p>
             Создайте новую запись
          </p>
        </field>
    </record>



    <record id="base_multi_sync_log_view_tree" model="ir.ui.view">
        <field name="name">base.multi_sync_log.tree</field>
        <field name="model">base.multi_sync_log</field>
        <field name="arch" type="xml">
            <tree>
                <field name="date"/>
                <field name="name"/>
                <field name="server_id"/>
            </tree>
        </field>
    </record>

    <record id="base_multi_sync_log_action" model="ir.actions.act_window">
        <field name="name">Результаты синхронизации</field>
        <field name="res_model">base.multi_sync_log</field>
        <field name="view_mode">tree,form</field>
        <field name="help" type="html">
          <p>
             Создайте новую запись
          </p>
        </field>
    </record> -->

  
   
</odoo>